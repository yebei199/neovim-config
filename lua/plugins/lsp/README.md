# lsp - 语言服务器与智能编辑

本目录包含与LSP（Language Server Protocol）相关的插件配置。这些插件实现了现代IDE常见的智能代码编辑功能，如代码补全、错误检查、代码跳转等。

## LSP概述

LSP是一种标准协议，使编辑器和语言特定工具（如编译器、linter等）之间的通信标准化。通过LSP，Neovim可以：
- 获得强大的代码补全和符号导航
- 实时的语法检查和错误提示
- 自动代码格式化和重构
- 调试和代码分析

## 插件说明

### mason.lua - 工具管理
Mason是Neovim的包管理器，自动安装和管理LSP服务器、格式化工具、linter等：
- 自动下载和安装LSP服务器
- 管理工具的版本和更新
- 提供统一的命令行界面

Mason简化了工具链的管理，无需手动安装。

### treesitter.lua - 语法树解析
Treesitter提供了精确的代码语法树解析：
- 提高代码高亮的准确性
- 支持结构化的代码折叠
- 为文本对象和motions提供支持
- 比正则表达式更强大和准确

该插件是多个高级编辑功能的基础。

### complete.lua - 自动补全
配置代码补全功能：
- 基于LSP的智能补全
- 代码片段支持
- 补全菜单的定制和优化
- 符号和参数的智能推荐

补全系统为编码提速和减少错误。

### diagnostic.lua - 错误诊断
实时代码诊断和错误提示：
- 显示编译错误和warning
- linter的警告提示
- 诊断信息的集中展示
- 快速导航到错误位置

这帮助开发者快速发现和修复问题。

### format.lua - 代码格式化
管理代码格式化功能：
- 集成格式化工具（rustfmt、black等）
- 自动和手动格式化选项
- 格式化规则的项目级配置
- 与LSP格式化的协调

好的代码格式化提高团队协作效率。

### todo.lua - TODO注释管理
识别和导航代码中的TODO注释：
- 高亮显示TODO、FIXME等注释
- 快速导航到注释位置
- TODO列表的汇总视图

这帮助管理开发中的任务和改进事项。

### trouble.lua - 诊断窗口
提供了诊断信息的集中展示窗口：
- 显示所有诊断信息（错误、警告等）
- 按严重性排序
- 快速导航到问题位置
- 搜索和过滤诊断

这是处理代码问题的中心枢纽。

## LSP工作流

使用LSP插件的典型工作流：
1. 打开代码文件
2. Mason自动启动相应的LSP服务器
3. Treesitter提供语法树解析
4. 编辑时得到实时补全和诊断
5. 使用快捷键进行代码导航和重构
6. 保存时自动格式化

## 语言特定配置

每种编程语言的LSP配置定义在 `config/langs/` 目录，这些插件则提供了LSP功能的框架和UI。

## 性能考虑

LSP功能虽然强大但也比较耗资源，项目的设计考虑了：
- 延迟加载LSP服务器
- 需要时才启动特定语言的服务器
- 定期清理不活跃的服务器
- 优化诊断更新频率
